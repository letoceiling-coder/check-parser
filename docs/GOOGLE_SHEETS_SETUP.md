# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å Google Sheets

**–í–µ—Ä—Å–∏—è:** 1.0  
**–î–∞—Ç–∞:** 2026-02-05  
**–°–∏—Å—Ç–µ–º–∞:** LEXAUTO Raffle v7.0

---

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–û–±–∑–æ—Ä](#–æ–±–∑–æ—Ä)
2. [–®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ –≤ Google Cloud](#—à–∞–≥-1-—Å–æ–∑–¥–∞–Ω–∏–µ-–ø—Ä–æ–µ–∫—Ç–∞-–≤-google-cloud)
3. [–®–∞–≥ 2: –í–∫–ª—é—á–µ–Ω–∏–µ Google Sheets API](#—à–∞–≥-2-–≤–∫–ª—é—á–µ–Ω–∏–µ-google-sheets-api)
4. [–®–∞–≥ 3: –°–æ–∑–¥–∞–Ω–∏–µ Service Account](#—à–∞–≥-3-—Å–æ–∑–¥–∞–Ω–∏–µ-service-account)
5. [–®–∞–≥ 4: –°–æ–∑–¥–∞–Ω–∏–µ –∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ –∫–ª—é—á–∞](#—à–∞–≥-4-—Å–æ–∑–¥–∞–Ω–∏–µ-–∏-—Å–∫–∞—á–∏–≤–∞–Ω–∏–µ-–∫–ª—é—á–∞)
6. [–®–∞–≥ 5: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Google –¢–∞–±–ª–∏—Ü—ã](#—à–∞–≥-5-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-google-—Ç–∞–±–ª–∏—Ü—ã)
7. [–®–∞–≥ 6: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Laravel](#—à–∞–≥-6-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-laravel)
8. [–®–∞–≥ 7: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ](#—à–∞–≥-7-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
9. [Troubleshooting](#troubleshooting)

---

## –û–±–∑–æ—Ä

–ü—Ä–∏ –æ–¥–æ–±—Ä–µ–Ω–∏–∏ –∑–∞–∫–∞–∑–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º –¥–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ Google –¢–∞–±–ª–∏—Ü—É:

| ID –∑–∞–∫–∞–∑–∞ | –§–ò–û | –¢–µ–ª–µ—Ñ–æ–Ω | –°—É–º–º–∞ | –ù–æ–º–µ—Ä–∞ | –î–∞—Ç–∞ |
|-----------|-----|---------|-------|--------|------|
| 123 | –ò–≤–∞–Ω–æ–≤ –ò.–ò. | +79991234567 | 20000 | 55, 56 | 04.02.2026 15:30 |

–î–ª—è —Ä–∞–±–æ—Ç—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **Service Account** ‚Äî —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç Google –¥–ª—è —Å–µ—Ä–≤–µ—Ä–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π.

---

## –®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ –≤ Google Cloud

### 1.1. –ü–µ—Ä–µ–π—Ç–∏ –≤ Google Cloud Console

üîó https://console.cloud.google.com/

### 1.2. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç

1. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –≤—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–µ–∫—Ç–æ–≤ (–≤–≤–µ—Ä—Ö—É —Å–ª–µ–≤–∞, —Ä—è–¥–æ–º —Å "Google Cloud")
2. –ù–∞–∂–º–∏—Ç–µ **"–°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–µ–∫—Ç"** (–∏–ª–∏ "New Project")
3. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ:
   - **–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞:** `lexauto-raffle-bot` (–∏–ª–∏ –ª—é–±–æ–µ)
   - **–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è:** –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –ø—É—Å—Ç—ã–º
4. –ù–∞–∂–º–∏—Ç–µ **"–°–æ–∑–¥–∞—Ç—å"** (Create)
5. –î–æ–∂–¥–∏—Ç–µ—Å—å —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞ (30-60 —Å–µ–∫—É–Ω–¥)
6. –í—ã–±–µ—Ä–∏—Ç–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –≤ –≤—ã–ø–∞–¥–∞—é—â–µ–º —Å–ø–∏—Å–∫–µ

‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω –∏ –≤—ã–±—Ä–∞–Ω

---

## –®–∞–≥ 2: –í–∫–ª—é—á–µ–Ω–∏–µ Google Sheets API

### 2.1. –û—Ç–∫—Ä—ã—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É API

1. –í –ª–µ–≤–æ–º –º–µ–Ω—é –Ω–∞–∂–º–∏—Ç–µ **"APIs & Services"** ‚Üí **"Library"**  
   (–∏–ª–∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ —Å—Å—ã–ª–∫–µ: https://console.cloud.google.com/apis/library)

### 2.2. –ù–∞–π—Ç–∏ –∏ –≤–∫–ª—é—á–∏—Ç—å Google Sheets API

1. –í –ø–æ–∏—Å–∫–µ –≤–≤–µ–¥–∏—Ç–µ: **"Google Sheets API"**
2. –ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ **"Google Sheets API"** –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö
3. –ù–∞–∂–º–∏—Ç–µ **"Enable"** (–í–∫–ª—é—á–∏—Ç—å)
4. –î–æ–∂–¥–∏—Ç–µ—Å—å –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ (5-10 —Å–µ–∫—É–Ω–¥)

‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç:** Google Sheets API –≤–∫–ª—é—á—ë–Ω –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞

---

## –®–∞–≥ 3: –°–æ–∑–¥–∞–Ω–∏–µ Service Account

### 3.1. –ü–µ—Ä–µ–π—Ç–∏ –≤ —Ä–∞–∑–¥–µ–ª Service Accounts

1. –í –ª–µ–≤–æ–º –º–µ–Ω—é: **"APIs & Services"** ‚Üí **"Credentials"**
2. –ù–∞–∂–º–∏—Ç–µ **"Create Credentials"** ‚Üí **"Service account"**

### 3.2. –ó–∞–ø–æ–ª–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ Service Account

**–≠–∫—Ä–∞–Ω 1: Service account details**
- **Service account name:** `lexauto-sheets-writer` (–∏–ª–∏ –ª—é–±–æ–µ)
- **Service account ID:** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ `lexauto-sheets-writer@project-id.iam.gserviceaccount.com`
- **Description:** `Service account for writing raffle data to Google Sheets`
- –ù–∞–∂–º–∏—Ç–µ **"Create and Continue"**

**–≠–∫—Ä–∞–Ω 2: Grant this service account access to project**
- **Select a role:** –≤—ã–±–µ—Ä–∏—Ç–µ **"Editor"** (–∏–ª–∏ –º–æ–∂–Ω–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å, –ø—Ä–∞–≤–∞ –Ω–∞—Å—Ç—Ä–æ–∏–º –≤ —Ç–∞–±–ª–∏—Ü–µ)
- –ù–∞–∂–º–∏—Ç–µ **"Continue"**

**–≠–∫—Ä–∞–Ω 3: Grant users access to this service account**
- –ú–æ–∂–Ω–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å
- –ù–∞–∂–º–∏—Ç–µ **"Done"**

‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç:** Service Account —Å–æ–∑–¥–∞–Ω

### 3.3. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å email Service Account

–í —Å–ø–∏—Å–∫–µ Service Accounts –Ω–∞–π–¥–∏—Ç–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç –∏ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –µ–≥–æ **email**:

```
lexauto-sheets-writer@project-id-123456.iam.gserviceaccount.com
```

‚ö†Ô∏è **–≠—Ç–æ—Ç email –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ç–∞–±–ª–∏—Ü–µ!**

---

## –®–∞–≥ 4: –°–æ–∑–¥–∞–Ω–∏–µ –∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ –∫–ª—é—á–∞

### 4.1. –û—Ç–∫—Ä—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Service Account

1. –í —Å–ø–∏—Å–∫–µ Service Accounts –∫–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ —Å–æ–∑–¥–∞–Ω–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **"Keys"**

### 4.2. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –∫–ª—é—á

1. –ù–∞–∂–º–∏—Ç–µ **"Add Key"** ‚Üí **"Create new key"**
2. –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –∫–ª—é—á–∞: **"JSON"**
3. –ù–∞–∂–º–∏—Ç–µ **"Create"**

### 4.3. –°–∫–∞—á–∏–≤–∞–Ω–∏–µ

- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫–∞—á–∞–µ—Ç—Å—è —Ñ–∞–π–ª —Ç–∏–ø–∞: `project-id-123456-abcdef123456.json`
- –ü–µ—Ä–µ–∏–º–µ–Ω—É–π—Ç–µ –µ–≥–æ –≤ `service-account.json` –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞

‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç:** JSON-–∫–ª—é—á —Å–∫–∞—á–∞–Ω

### 4.4. –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫–ª—é—á–∞

–§–∞–π–ª –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫:

```json
{
  "type": "service_account",
  "project_id": "lexauto-123456",
  "private_key_id": "abc123...",
  "private_key": "-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----\n",
  "client_email": "lexauto-sheets-writer@project-id-123456.iam.gserviceaccount.com",
  "client_id": "123456789...",
  "auth_uri": "https://accounts.google.com/o/oauth2/auth",
  "token_uri": "https://oauth2.googleapis.com/token",
  ...
}
```

‚ö†Ô∏è **–í–ê–ñ–ù–û:** –≠—Ç–æ—Ç —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á. –ù–µ –∫–æ–º–º–∏—Ç–∏—Ç—å –≤ Git!

---

## –®–∞–≥ 5: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Google –¢–∞–±–ª–∏—Ü—ã

### 5.1. –°–æ–∑–¥–∞—Ç—å Google –¢–∞–±–ª–∏—Ü—É

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ https://sheets.google.com/
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é —Ç–∞–±–ª–∏—Ü—É: **"–ü—É—Å—Ç–æ–π —Ñ–∞–π–ª"**
3. –ù–∞–∑–æ–≤–∏—Ç–µ –µ—ë: `LEXAUTO –†–æ–∑—ã–≥—Ä—ã—à - –£—á–∞—Å—Ç–Ω–∏–∫–∏`

### 5.2. –î–æ–±–∞–≤–∏—Ç—å –∑–∞–≥–æ–ª–æ–≤–∫–∏

–í –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–µ –≤–≤–µ–¥–∏—Ç–µ:

| A | B | C | D | E | F |
|---|---|---|---|---|---|
| ID –∑–∞–∫–∞–∑–∞ | –§–ò–û | –¢–µ–ª–µ—Ñ–æ–Ω | –°—É–º–º–∞ | –ù–æ–º–µ—Ä–∞ | –î–∞—Ç–∞ |

### 5.3. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å ID —Ç–∞–±–ª–∏—Ü—ã

URL —Ç–∞–±–ª–∏—Ü—ã –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫:
```
https://docs.google.com/spreadsheets/d/1AbC2DeFgH3iJkLmN4oPqR5sTuVwXyZ/edit
                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                       –≠—Ç–æ ID —Ç–∞–±–ª–∏—Ü—ã
```

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ ID: `1AbC2DeFgH3iJkLmN4oPqR5sTuVwXyZ`

### 5.4. –î–∞—Ç—å –¥–æ—Å—Ç—É–ø Service Account ‚≠ê –ö–†–ò–¢–ò–ß–ù–û

1. –í —Ç–∞–±–ª–∏—Ü–µ –Ω–∞–∂–º–∏—Ç–µ **"–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–æ—Å—Ç—É–ø–∞"** (–∫–Ω–æ–ø–∫–∞ "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è" —Å–ø—Ä–∞–≤–∞ –≤–≤–µ—Ä—Ö—É)
2. –í –ø–æ–ª–µ **"–î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"** –≤—Å—Ç–∞–≤—å—Ç–µ email Service Account:
   ```
   lexauto-sheets-writer@project-id-123456.iam.gserviceaccount.com
   ```
3. –í—ã–±–µ—Ä–∏—Ç–µ —Ä–æ–ª—å: **"–†–µ–¥–∞–∫—Ç–æ—Ä"**
4. **–°–Ω–∏–º–∏—Ç–µ –≥–∞–ª–æ—á–∫—É** "–û—Ç–ø—Ä–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è"
5. –ù–∞–∂–º–∏—Ç–µ **"–ü–æ–¥–µ–ª–∏—Ç—å—Å—è"**

‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç:** Service Account –º–æ–∂–µ—Ç –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å –≤ —Ç–∞–±–ª–∏—Ü—É

---

## –®–∞–≥ 6: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Laravel

### 6.1. –ü–æ–ª–æ–∂–∏—Ç—å –∫–ª—é—á –Ω–∞ —Å–µ—Ä–≤–µ—Ä

**–ù–∞ –ª–æ–∫–∞–ª—å–Ω–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏):**
```bash
mkdir -p storage/app/google
cp /path/to/service-account.json storage/app/google/service-account.json
```

**–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ:**
```bash
ssh root@89.169.39.244
cd /var/www/auto.siteaccess.ru
mkdir -p storage/app/google
nano storage/app/google/service-account.json
# –í—Å—Ç–∞–≤–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ JSON-—Ñ–∞–π–ª–∞, —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å (Ctrl+O, Enter, Ctrl+X)
chmod 600 storage/app/google/service-account.json
```

### 6.2. –î–æ–±–∞–≤–∏—Ç—å –≤ .gitignore

**–§–∞–π–ª:** `.gitignore`

–î–æ–±–∞–≤—å—Ç–µ —Å—Ç—Ä–æ–∫—É:
```
storage/app/google/
```

### 6.3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å .env

**–§–∞–π–ª:** `.env`

–î–æ–±–∞–≤—å—Ç–µ:
```env
# Google Sheets Integration
GOOGLE_APPLICATION_CREDENTIALS=storage/app/google/service-account.json
GOOGLE_SHEETS_ENABLED=true
```

### 6.4. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–∞–∫–µ—Ç

–î–ª—è Laravel –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —Ä–∞–±–æ—Ç—ã —Å Google Sheets:

#### –í–∞—Ä–∏–∞–Ω—Ç A: Google API Client (–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π)
```bash
composer require google/apiclient:"^2.15"
```

#### –í–∞—Ä–∏–∞–Ω—Ç B: Laravel Google Sheets (–æ–±—ë—Ä—Ç–∫–∞)
```bash
composer require revolution/laravel-google-sheets
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –í–∞—Ä–∏–∞–Ω—Ç A (–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –∫–ª–∏–µ–Ω—Ç) –±–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª–µ–Ω –∏ –≥–∏–±–æ–∫.

### 6.5. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –≤ –∞–¥–º–∏–Ω–∫–µ –±–æ—Ç–∞

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ: https://auto.siteaccess.ru/bot-settings
2. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞
3. –ù–∞–π–¥–∏—Ç–µ –ø–æ–ª–µ **"Google Sheet URL"**
4. –í—Å—Ç–∞–≤—å—Ç–µ –ø–æ–ª–Ω—É—é —Å—Å—ã–ª–∫—É –Ω–∞ —Ç–∞–±–ª–∏—Ü—É:
   ```
   https://docs.google.com/spreadsheets/d/1AbC2DeFgH3iJkLmN4oPqR5sTuVwXyZ/edit
   ```
5. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ

‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ –ë–î

---

## –®–∞–≥ 7: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 7.1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Service Account

```bash
php artisan tinker
```

```php
$client = new \Google\Client();
$client->setAuthConfig(storage_path('app/google/service-account.json'));
$client->addScope(\Google\Service\Sheets::SPREADSHEETS);

$service = new \Google\Service\Sheets($client);
$spreadsheetId = '1AbC2DeFgH3iJkLmN4oPqR5sTuVwXyZ'; // –í–∞—à ID

// –ü–æ–ø—ã—Ç–∫–∞ —á—Ç–µ–Ω–∏—è
$range = 'Sheet1!A1:F1';
$response = $service->spreadsheets_values->get($spreadsheetId, $range);
print_r($response->getValues());
// –î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å: [['ID –∑–∞–∫–∞–∑–∞', '–§–ò–û', '–¢–µ–ª–µ—Ñ–æ–Ω', '–°—É–º–º–∞', '–ù–æ–º–µ—Ä–∞', '–î–∞—Ç–∞']]
```

–ï—Å–ª–∏ **–æ—à–∏–±–∫–∞ 403** ‚Äî Service Account –Ω–µ –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —Ç–∞–±–ª–∏—Ü–µ (–≤–µ—Ä–Ω–∏—Ç–µ—Å—å –∫ —à–∞–≥—É 5.4).

### 7.2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–ø–∏—Å—å

```php
// –¢–µ—Å—Ç–æ–≤–∞—è –∑–∞–ø–∏—Å—å
$values = [
    ['999', '–¢–µ—Å—Ç –¢–µ—Å—Ç–æ–≤', '+79999999999', '10000', '1, 2, 3', date('d.m.Y H:i')]
];

$body = new \Google\Service\Sheets\ValueRange(['values' => $values]);
$params = ['valueInputOption' => 'RAW'];
$result = $service->spreadsheets_values->append(
    $spreadsheetId,
    'Sheet1!A:F',
    $body,
    $params
);

echo "–ó–∞–ø–∏—Å–∞–Ω–æ —Å—Ç—Ä–æ–∫: " . $result->getUpdates()->getUpdatedRows();
```

‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –°—Ç—Ä–æ–∫–∞ –ø–æ—è–≤–∏–ª–∞—Å—å –≤ —Ç–∞–±–ª–∏—Ü–µ

### 7.3. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ (Artisan –∫–æ–º–∞–Ω–¥–∞)

```bash
php artisan sheets:init-headers
```

–ö–æ–º–∞–Ω–¥–∞:
1. –ù–∞—Ö–æ–¥–∏—Ç –≤—Å–µ –±–æ—Ç—ã —Å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º `google_sheet_url`
2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ
3. –í—ã–≤–æ–¥–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç

### 7.4. –¢–µ—Å—Ç —Å —Ä–µ–∞–ª—å–Ω—ã–º –∑–∞–∫–∞–∑–æ–º

1. –í Telegram –±–æ—Ç–µ: –æ—Ç–ø—Ä–∞–≤–∏—Ç—å `/start` ‚Üí —Å–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑ ‚Üí –∑–∞–≥—Ä—É–∑–∏—Ç—å —á–µ–∫
2. –ê–¥–º–∏–Ω –æ–¥–æ–±—Ä—è–µ—Ç –∑–∞–∫–∞–∑
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Google –¢–∞–±–ª–∏—Ü—É ‚Äî –¥–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è –Ω–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞

---

## Troubleshooting

### –û—à–∏–±–∫–∞: "Unable to parse the credentials"

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç JSON-—Ñ–∞–π–ª–∞ –∏–ª–∏ —Ñ–∞–π–ª –ø–æ–≤—Ä–µ–∂–¥–µ–Ω.

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞: `cat storage/app/google/service-account.json`
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —ç—Ç–æ –≤–∞–ª–∏–¥–Ω—ã–π JSON (–º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ jsonlint.com)
3. –°–∫–∞—á–∞–π—Ç–µ –∫–ª—é—á –∑–∞–Ω–æ–≤–æ –∏–∑ Google Cloud Console

### –û—à–∏–±–∫–∞ 403: "The caller does not have permission"

**–ü—Ä–∏—á–∏–Ω–∞:** Service Account –Ω–µ –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —Ç–∞–±–ª–∏—Ü–µ.

**–†–µ—à–µ–Ω–∏–µ:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ Google –¢–∞–±–ª–∏—Ü—É
2. –ù–∞–∂–º–∏—Ç–µ "–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–æ—Å—Ç—É–ø–∞" (Share)
3. –î–æ–±–∞–≤—å—Ç–µ email Service Account –∫–∞–∫ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ email –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π (–∏–∑ JSON-—Ñ–∞–π–ª–∞ `client_email`)

### –û—à–∏–±–∫–∞ 404: "Requested entity was not found"

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–≤–µ—Ä–Ω—ã–π ID —Ç–∞–±–ª–∏—Ü—ã –∏–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ —É–¥–∞–ª–µ–Ω–∞.

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ URL —Ç–∞–±–ª–∏—Ü—ã
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ ID —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ
3. –û—Ç–∫—Ä–æ–π—Ç–µ —Ç–∞–±–ª–∏—Ü—É –≤ –±—Ä–∞—É–∑–µ—Ä–µ ‚Äî –µ—Å–ª–∏ –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è, —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é

### –û—à–∏–±–∫–∞: "Google_Service_Exception: Invalid grant"

**–ü—Ä–∏—á–∏–Ω–∞:** –í—Ä–µ–º—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –Ω–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ.

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
timedatectl status
ntpdate -u pool.ntp.org
# –∏–ª–∏
systemctl restart systemd-timesyncd
```

### –ó–∞–ø–∏—Å—å –Ω–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:**
1. –õ–æ–≥–∏ Laravel: `tail -f storage/logs/laravel.log | grep Sheets`
2. –ü—Ä–∞–≤–∞ –Ω–∞ —Ñ–∞–π–ª –∫–ª—é—á–∞: `ls -l storage/app/google/service-account.json` (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 600)
3. `.env` –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã: `php artisan config:cache`
4. –¢–∞–±–ª–∏—Ü–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –¥–æ—Å—Ç—É–ø–Ω–∞: –æ—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ

---

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ó–∞—â–∏—Ç–∞ –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞

‚ö†Ô∏è **–í–ê–ñ–ù–û:**

1. **–ù–ï –∫–æ–º–º–∏—Ç–∏—Ç—å** `service-account.json` –≤ Git
2. –î–æ–±–∞–≤–∏—Ç—å –≤ `.gitignore`: `storage/app/google/`
3. –ü—Ä–∞–≤–∞ –Ω–∞ —Ñ–∞–π–ª: `chmod 600 service-account.json`
4. –ù–∞ production-—Å–µ—Ä–≤–µ—Ä–µ —Ö—Ä–∞–Ω–∏—Ç—å –≤ –∑–∞—â–∏—â—ë–Ω–Ω–æ–º –º–µ—Å—Ç–µ
5. –ï—Å–ª–∏ –∫–ª—é—á —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω ‚Äî —É–¥–∞–ª–∏—Ç—å –≤ Google Cloud Console –∏ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø—Ä–∞–≤ Service Account

Service Account –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –¥–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º —Ç–∞–±–ª–∏—Ü–∞–º:

1. –ù–µ –¥–∞–≤–∞–π—Ç–µ –ø—Ä–∞–≤–∞ –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ (Editor/Owner)
2. –î–∞–≤–∞–π—Ç–µ –¥–æ—Å—Ç—É–ø –Ω–∞ —É—Ä–æ–≤–Ω–µ –∫–∞–∂–¥–æ–π —Ç–∞–±–ª–∏—Ü—ã –æ—Ç–¥–µ–ª—å–Ω–æ (Share ‚Üí email SA ‚Üí –†–µ–¥–∞–∫—Ç–æ—Ä)
3. –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–æ–ª—å "Viewer" –≤ –ø—Ä–æ–µ–∫—Ç–µ, –∞ "Editor" —Ç–æ–ª—å–∫–æ –≤ —Ç–∞–±–ª–∏—Ü–µ

---

## –§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö –≤ Google Sheets

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ã

**–õ–∏—Å—Ç:** `Sheet1` (–∏–ª–∏ –∫–∞—Å—Ç–æ–º–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö)

**–ó–∞–≥–æ–ª–æ–≤–∫–∏ (—Å—Ç—Ä–æ–∫–∞ 1):**
| A | B | C | D | E | F |
|---|---|---|---|---|---|
| ID –∑–∞–∫–∞–∑–∞ | –§–ò–û | –¢–µ–ª–µ—Ñ–æ–Ω | –°—É–º–º–∞ | –ù–æ–º–µ—Ä–∞ | –î–∞—Ç–∞ |

**–î–∞–Ω–Ω—ã–µ (—Å—Ç—Ä–æ–∫–∏ 2+):**
| A | B | C | D | E | F |
|---|---|---|---|---|---|
| 1 | –ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á | +79991234567 | 10000 | 55 | 04.02.2026 15:30 |
| 2 | –ü–µ—Ç—Ä–æ–≤ –ü–µ—Ç—Ä | +79991112233 | 20000 | 56, 57 | 04.02.2026 16:15 |
| 3 | –°–∏–¥–æ—Ä–æ–≤ –°–∏–¥–æ—Ä | +79998887766 | 50000 | 58, 59, 60, 61, 62 | 04.02.2026 17:00 |

### –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö

- **ID –∑–∞–∫–∞–∑–∞:** —á–∏—Å–ª–æ (integer)
- **–§–ò–û:** —Ç–µ–∫—Å—Ç (—Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–∑ `fio_encrypted`)
- **–¢–µ–ª–µ—Ñ–æ–Ω:** —Ç–µ–∫—Å—Ç (—Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–∑ `phone_encrypted`)
- **–°—É–º–º–∞:** —á–∏—Å–ª–æ –±–µ–∑ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (20000, –Ω–µ "20 000")
- **–ù–æ–º–µ—Ä–∞:** —Ç–µ–∫—Å—Ç, —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é ("55, 56, 57")
- **–î–∞—Ç–∞:** —Ç–µ–∫—Å—Ç, —Ñ–æ—Ä–º–∞—Ç "dd.mm.yyyy HH:MM" ("04.02.2026 15:30")

---

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –ù–µ—Å–∫–æ–ª—å–∫–æ –±–æ—Ç–æ–≤ ‚Üí –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–∞–±–ª–∏—Ü

–ö–∞–∂–¥—ã–π –±–æ—Ç –º–æ–∂–µ—Ç –∏–º–µ—Ç—å —Å–≤–æ—é —Ç–∞–±–ª–∏—Ü—É:

1. –°–æ–∑–¥–∞–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω—É—é —Ç–∞–±–ª–∏—Ü—É –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –±–æ—Ç–∞
2. –í –∞–¥–º–∏–Ω–∫–µ –∫–∞–∂–¥–æ–≥–æ –±–æ—Ç–∞ —É–∫–∞–∂–∏—Ç–µ —Å–≤–æ–π `google_sheet_url`
3. –î–∞–π—Ç–µ –¥–æ—Å—Ç—É–ø Service Account –∫ –∫–∞–∂–¥–æ–π —Ç–∞–±–ª–∏—Ü–µ

### –†–∞–∑–Ω—ã–µ —Ä–æ–∑—ã–≥—Ä—ã—à–∏ ‚Üí —Ä–∞–∑–Ω—ã–µ –ª–∏—Å—Ç—ã

–ú–æ–∂–Ω–æ –ø–∏—Å–∞—Ç—å –∫–∞–∂–¥—ã–π —Ä–æ–∑—ã–≥—Ä—ã—à –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–π –ª–∏—Å—Ç:

**–í GoogleSheetsService:**
```php
$sheetName = '–†–æ–∑—ã–≥—Ä—ã—à #' . $order->raffle_id;

Sheets::spreadsheet($sheetId)
    ->sheet($sheetName)
    ->append([$row]);
```

–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ —Å–æ–∑–¥–∞–π—Ç–µ –ª–∏—Å—Ç –≤ —Ç–∞–±–ª–∏—Ü–µ –∏–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ.

### –≠–∫—Å–ø–æ—Ä—Ç –≤ –¥—Ä—É–≥–∏–µ —Ñ–æ—Ä–º–∞—Ç—ã

Google Sheets API –ø–æ–∑–≤–æ–ª—è–µ—Ç:
- –≠–∫—Å–ø–æ—Ä—Ç –≤ CSV/Excel/PDF
- –°–æ–∑–¥–∞–Ω–∏–µ —Å–≤–æ–¥–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü
- –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —è—á–µ–µ–∫
- –§–æ—Ä–º—É–ª—ã –∏ –≥—Ä–∞—Ñ–∏–∫–∏

–°–º. –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é: https://developers.google.com/sheets/api

---

## –ß–µ–∫–ª–∏—Å—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

- [ ] –°–æ–∑–¥–∞–Ω –ø—Ä–æ–µ–∫—Ç –≤ Google Cloud Console
- [ ] –í–∫–ª—é—á—ë–Ω Google Sheets API
- [ ] –°–æ–∑–¥–∞–Ω Service Account
- [ ] –°–∫–∞—á–∞–Ω JSON-–∫–ª—é—á
- [ ] Email Service Account —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω
- [ ] –°–æ–∑–¥–∞–Ω–∞ Google –¢–∞–±–ª–∏—Ü–∞
- [ ] –î–æ–±–∞–≤–ª–µ–Ω—ã –∑–∞–≥–æ–ª–æ–≤–∫–∏ –≤ —Ç–∞–±–ª–∏—Ü—É
- [ ] Service Account –¥–æ–±–∞–≤–ª–µ–Ω –∫–∞–∫ —Ä–µ–¥–∞–∫—Ç–æ—Ä —Ç–∞–±–ª–∏—Ü—ã
- [ ] JSON-–∫–ª—é—á –ø–æ–ª–æ–∂–µ–Ω –≤ `storage/app/google/service-account.json`
- [ ] –î–æ–±–∞–≤–ª–µ–Ω–æ –≤ `.gitignore`: `storage/app/google/`
- [ ] –ü—Ä–∞–≤–∞ –Ω–∞ –∫–ª—é—á: `chmod 600`
- [ ] `.env` –Ω–∞—Å—Ç—Ä–æ–µ–Ω (GOOGLE_APPLICATION_CREDENTIALS)
- [ ] URL —Ç–∞–±–ª–∏—Ü—ã –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∞–¥–º–∏–Ω–∫–µ –±–æ—Ç–∞
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞: `php artisan tinker` ‚Üí —á—Ç–µ–Ω–∏–µ/–∑–∞–ø–∏—Å—å
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞: —Å–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π –∑–∞–∫–∞–∑ ‚Üí –æ–¥–æ–±—Ä–∏—Ç—å ‚Üí –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É

---

## –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- üìö Google Sheets API Documentation: https://developers.google.com/sheets/api
- üîë Service Account Keys: https://console.cloud.google.com/iam-admin/serviceaccounts
- üìä Google Sheets: https://sheets.google.com
- üíª Google API PHP Client: https://github.com/googleapis/google-api-php-client

---

## –ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞

### –ó–∞–ø–∏—Å—å –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏

```php
use Google\Client;
use Google\Service\Sheets;

$client = new Client();
$client->setAuthConfig(storage_path('app/google/service-account.json'));
$client->addScope(Sheets::SPREADSHEETS);

$service = new Sheets($client);
$spreadsheetId = '1AbC2DeFgH3iJkLmN4oPqR5sTuVwXyZ';

$values = [
    [1, '–ò–≤–∞–Ω–æ–≤ –ò.–ò.', '+79991234567', 10000, '55', '04.02.2026 15:30']
];

$body = new Sheets\ValueRange(['values' => $values]);
$params = ['valueInputOption' => 'RAW'];

$result = $service->spreadsheets_values->append(
    $spreadsheetId,
    'Sheet1!A:F',
    $body,
    $params
);

echo "–î–æ–±–∞–≤–ª–µ–Ω–æ —Å—Ç—Ä–æ–∫: " . $result->getUpdates()->getUpdatedRows();
```

### –ß—Ç–µ–Ω–∏–µ –¥–∏–∞–ø–∞–∑–æ–Ω–∞

```php
$range = 'Sheet1!A2:F100'; // –°—Ç—Ä–æ–∫–∏ 2-100
$response = $service->spreadsheets_values->get($spreadsheetId, $range);
$values = $response->getValues();

foreach ($values as $row) {
    echo "ID: {$row[0]}, –§–ò–û: {$row[1]}, –¢–µ–ª–µ—Ñ–æ–Ω: {$row[2]}\n";
}
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —è—á–µ–π–∫–∏

```php
$range = 'Sheet1!D2'; // –Ø—á–µ–π–∫–∞ D2 (—Å—É–º–º–∞)
$values = [[25000]];
$body = new Sheets\ValueRange(['values' => $values]);
$params = ['valueInputOption' => 'RAW'];

$result = $service->spreadsheets_values->update(
    $spreadsheetId,
    $range,
    $body,
    $params
);
```

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤:
‚úÖ Google Sheets API –Ω–∞—Å—Ç—Ä–æ–µ–Ω  
‚úÖ Service Account —Å–æ–∑–¥–∞–Ω –∏ –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø  
‚úÖ Laravel –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –∑–∞–ø–∏—Å–∏  
‚úÖ –¢–∞–±–ª–∏—Ü–∞ –≥–æ—Ç–æ–≤–∞ –∫ –ø—Ä–∏–µ–º—É –¥–∞–Ω–Ω—ã—Ö  

–ü—Ä–∏ –æ–¥–æ–±—Ä–µ–Ω–∏–∏ –∑–∞–∫–∞–∑–∞ –¥–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ Google –¢–∞–±–ª–∏—Ü—É. üéâ
